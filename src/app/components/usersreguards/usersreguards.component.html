<form class="pt-10"  [formGroup]="myForm" (ngSubmit)="onSubmit()" enctype="multipart/form-data">
<div class="card  mx-auto pt-20">
    <p-toolbar styleClass="mb-4 gap-2">
      <ng-template pTemplate="left">
        <button type="button" (click)="moreInputs()"
          class="
          min-w-auto w-32 h-10 bg-blue-300 p-2 rounded-t-xl hover:bg-blue-500 text-white font-semibold transition-transform hover:-translate-y-2 ease-in-out"
          pButton pRipple label="" icon="pi pi-plus">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg"
            viewBox="0 0 16 16">
            <path fill-rule="evenodd"
              d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z" />
          </svg>

        </button>
        <!-- <p-button type="button" icon="pi pi-chevron-left" (click)="prev()" [disabled]="isFirstPage()" styleClass="p-button-text">AFTER</p-button>
        <p-button type="button" icon="pi pi-refresh" (click)="reset()" styleClass="p-button-text">RESET</p-button>
        <p-button type="button" icon="pi pi-chevron-right" (click)="next()" [disabled]="isLastPage()" styleClass="p-button-text">MORE</p-button> -->
      </ng-template>
      <button class="absolute right-10 pr-12 min-w-auto w-32 h-10 bg-green-300 p-2 rounded-t-xl hover:bg-green-500 text-white font-semibold transition-transform hover:-translate-y-2 ease-in-out"  type="submit">Guardar</button>

      <ng-template pTemplate="right">
        <!-- <p-fileUpload mode="basic" accept="image/*" [maxFileSize]="1000000" label="Import" chooseLabel="Import" class="mr-2 inline-block"></p-fileUpload> -->
        <!-- <button pButton pRipple label="Export" icon="pi pi-upload" class="p-button-help"></button> -->
      </ng-template>
    </p-toolbar>
    <p-table  #dt [value]="guards" dataKey="id" editMode="row" [tableStyle]="{'min-width': '50rem'}"
      [paginator]="true" 
      [rows]="5"
      (onPage)="pageChange($event)"
      [showCurrentPageReport]="true"
      [rowsPerPageOptions]="[5,10, 25, 50]" 
      currentPageReportTemplate="Mostrando del {first} al {last} de {totalRecords} registros">
      <ng-template pTemplate="header">
        <tr>
          <th style="width:5%">Foto</th>
          <th style="width:10%">Numero de factura</th>
          <th style="width:11%">Nombre emisor</th>
          <th style="width:11%">Descripci√≥n del producto</th>
          <th style="width:8%">Cantidad o Pieza</th>
          <th style="width:8%">Valor</th>
          <th style="width:11%">Nombre del resguardante</th>
          <th style="width:11%">Departamento</th>
          <th style="width:7%">Numero consecutivo</th>
          <th style="width:7%">Numero de etiqueta</th>
          <th style="width:7%">Numero de nomina</th>
          <th style="width:5%"></th>

        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-guards let-editing="editing" let-ri="rowIndex">
     
        <tr class="" [pEditableRow]="guards">
          <td class="border-black border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <!-- component -->
                
                <ng-container *ngIf="!myForm.get('img'+guards.id)?.value" >

                  <input 
    [formControlName]="'picture' + guards.id"
    (change)="onFileChange($event, guards.id)"
    class="block w-70 mb-5 text-xs text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400" 
    id="small_size" 
    type="file"
  >
                </ng-container>


              </ng-template>
              <ng-template pTemplate="output">
                <div class="flex items-center justify-center">
                  <div class="rounded-md border border-gray-100 bg-white shadow-md">
                    <label for="upload" class="flex flex-col items-center gap-2 cursor-pointer">
                      <div *ngIf="myForm.get('img'+guards.id)?.value" class="h-20 w-20 bg-cover bg-center rounded-full"
                        [style.background-image]="'url(data:image/png;base64,' + myForm.get('img'+guards.id)?.value + ')'"></div>
                    
                    </label>
                  </div>
                </div>
                
              </ng-template>
            </p-cellEditor>
          </td>

          <td class="border-black border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <input  type="number"
                min="1"
                [formControlName]="'facture'+guards.id"
                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                  >
              </ng-template>
              <ng-template pTemplate="output">
                {{
                myForm.get('facture'+guards.id)?.value
                }}
              </ng-template>
            </p-cellEditor>
          </td>
          <td class="border-black border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <input pInputText type="text"
                [formControlName]="'emisor'+guards.id"
                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                  >
              </ng-template>
              <ng-template pTemplate="output">
                {{
                  myForm.get('emisor'+guards.id)?.value
                  }}
              </ng-template>
            </p-cellEditor>
          </td>
          <td class="border-black border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <input pInputText type="text"
                [formControlName]="'description'+guards.id"

                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                  >
              </ng-template>
              <ng-template pTemplate="output">
                {{
                  myForm.get('description'+guards.id)?.value
                  }}
              </ng-template>
            </p-cellEditor>
          </td>
          <td class="border-black border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <input pInputText type="text"
                [formControlName]="'type'+guards.id"
                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                  >
              </ng-template>
              <ng-template pTemplate="output">
                {{
                  myForm.get('type'+guards.id)?.value
                  }}
              </ng-template>
            </p-cellEditor>
          </td>
          <td class="border-black border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                
                <input pInputText type="number"
                min="1"
                [formControlName]="'value'+guards.id"
                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                  >
              </ng-template>
              <ng-template pTemplate="output">
                {{
                  myForm.get('value'+guards.id)?.value
                  }}
              </ng-template>
            </p-cellEditor>
          </td>
          <td class="border-black border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <input pInputText type="text"
                [formControlName]="'name'+guards.id"
                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                >
              </ng-template>
              <ng-template pTemplate="output">
                {{
                  myForm.get('name'+guards.id)?.value
                  }}
              </ng-template>
            </p-cellEditor>
          </td>
          <td class="border-black border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <input pInputText type="text"
                [formControlName]="'group'+guards.id"
                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                  >
              </ng-template>
              <ng-template pTemplate="output">
                {{
                  myForm.get('group'+guards.id)?.value
                  }}
              </ng-template>
            </p-cellEditor>
          </td>
          <td class="border-black  border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <input pInputText type="number"
                min="1"
                [formControlName]="'numberconsecutive'+guards.id"
                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                 required>
              </ng-template>
              <ng-template pTemplate="output">
                {{
                  myForm.get('numberconsecutive'+guards.id)?.value
                  }}
              </ng-template>
            </p-cellEditor>
          </td>
         
          <td class="border-black  border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <input pInputText type="number"
                min="1"
                [formControlName]="'label'+guards.id"
                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                >
              </ng-template>
              <ng-template pTemplate="output">
                {{
                  myForm.get('label'+guards.id)?.value
                  }}
              </ng-template>
            </p-cellEditor>
          </td>
          <td class="border-black  border-b">
            <p-cellEditor>
              <ng-template pTemplate="input">
                <input pInputText type="number"
                min="1"
                [formControlName]="'payroll'+guards.id"
                  class="appearance-none rounded-r rounded-l sm:rounded-l-none border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"
                  >
              </ng-template>
              <ng-template pTemplate="output">
                {{
                  myForm.get('payroll'+guards.id)?.value
                  }}
              </ng-template>
            </p-cellEditor>
          </td>
          <td class="border-black  border-b">
            <div class="flex align-items-center justify-content-center gap-2">
              <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                (click)="onRowEditInit(guards)"
                class="p-button-rounded p-button-text min-w-auto w-14 h-14 bg-yellow-300 p-2 rounded-full hover:bg-yellow-500 text-white font-semibold transition-rotation duration-300 hover:rotate-45 ease-in-out">

                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil"
                  viewBox="0 0 16 16">
                  <path
                    d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z" />
                </svg>
              </button>
           
              <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
              (click)="onRowDelete(ri)"
              class="p-button-rounded p-button-text min-w-auto w-14 h-14 bg-red-300 p-2 rounded-full hover:bg-red-500 text-white font-semibold transition-rotation duration-300 hover:rotate-45 ease-in-out">

              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
              </svg>
            </button>
            
            
            
            <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
              
            (click)="onRowEditSave(ri)"
              class="p-button-rounded p-button-text min-w-auto w-14 h-14 bg-yellow-300 p-2 rounded-full hover:bg-yellow-500 text-white font-semibold transition-rotation duration-300 hover:rotate-45 ease-in-out">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil"
                viewBox="0 0 16 16">
                <path
                  d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z" />
              </svg>

            </button>
          


              
              <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"
                (click)="onRowEditCancel(guards, ri)" class="p-button-rounded p-button-text p-button-danger
                      min-w-auto w-14 h-14 bg-red-300 p-2 rounded-full hover:bg-red-500 text-white font-semibold transition-rotation duration-300 hover:-rotate-45 ease-in-out
                      ">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg"
                  viewBox="0 0 16 16">
                  <path
                    d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                </svg>
              </button>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</form>

